<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Тренажёр «Сестринское дело»</title>
    <meta name="theme-color" content="#0f172a">
    <style>
      body { margin:0; font-family:system-ui; background:#0b1020; color:#e5e7eb; }
      .container{ max-width:1000px; margin:0 auto; padding:16px; }
      .card{ background:#0f172a; border:1px solid #1f2937; border-radius:12px; padding:16px; margin-bottom:16px; }
      .btn{ padding:8px 14px; border-radius:8px; border:1px solid #374151; background:#111827; color:#e5e7eb; cursor:pointer; }
      .btn:hover{ background:#1e293b; }
      .opt{ border:1px solid #374151; border-radius:10px; padding:10px; margin:6px 0; cursor:pointer; }
      .opt.correct{ background:#06220f; border-color:#16a34a; }
      .opt.wrong{ background:#210b0b; border-color:#dc2626; }
      .footer{ text-align:center; color:#9ca3af; margin-top:20px; font-size:12px; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Тренажёр‑тест «Сестринское дело»</h1>
      <div id="app">Загрузка...</div>
      <div class="footer">© 2025 Тренажёр. Прогресс сохраняется локально.</div>
    </div>
    <script>
      async function loadQuestions(){
        const txt = await fetch("questions.txt").then(r=>r.text());
        return txt.trim().split(/\n(?=\d+\.)/).map((block,i)=>{
          const lines = block.trim().split(/\n/);
          const num = parseInt(lines[0]);
          const qtext = lines[0].replace(/^\d+\.\s*/, "");
          const opts = lines.slice(1).map(l=>l.replace(/^\s*[АAБВГ]\)\s*/, ""));
          return {num, qtext, opts, correct: opts[0]};
        });
      }
      const app=document.getElementById("app");
      let questions=[], idx=0, answers={};
      function render(){
        if(idx>=questions.length){ app.innerHTML="<h2>Тест завершён!</h2><button class='btn' onclick='resetProgress()'>Сбросить прогресс</button>"; return; }
        const q=questions[idx];
        let html="<div class='card'><div><b>Вопрос "+q.num+"</b><p>"+q.qtext+"</p></div>";
        q.opts.forEach((opt,i)=>{
          let cls="opt"; if(answers[q.num]){ if(opt===q.correct) cls+=" correct"; else if(opt===answers[q.num]) cls+=" wrong"; }
          html+="<div class='"+cls+"' onclick='choose(""+q.num+"",""+opt.replace(/"/g,"&quot;")+"")'>"+["А","Б","В","Г"][i]+") "+opt+"</div>";
        });
        html+="</div><div><button class='btn' onclick='prev()'>← Назад</button> <button class='btn' onclick='next()'>Вперёд →</button></div>";
        app.innerHTML=html;
      }
      function choose(num,opt){ answers[num]=opt; save(); render(); }
      function prev(){ if(idx>0){ idx--; render(); } }
      function next(){ if(idx<questions.length-1){ idx++; render(); } else { render(); } }
      function save(){ localStorage.setItem("answers", JSON.stringify(answers)); }
      function resetProgress(){ localStorage.clear(); answers={}; idx=0; render(); }
      loadQuestions().then(qs=>{ questions=qs; const saved=localStorage.getItem("answers"); if(saved) answers=JSON.parse(saved); render(); });
    </script>
  </body>
</html>
